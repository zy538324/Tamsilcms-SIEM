1. PURPOSE AND RISK MODEL
Core purpose

Vulnerability Management exists to answer five questions precisely:

What weaknesses exist in our environment?

Where are they, exactly?

How credible is exploitation in our context?

What should be done, in what order?

Can we prove that we managed the risk responsibly?

It does not detect active compromise.
It does not remediate silently.
It does not close its own findings.

It produces risk statements, not incidents.

Threat and failure assumptions

This system must assume:

Scanners are imperfect and noisy

CVSS scores are insufficient on their own

Not all vulnerabilities should be fixed immediately

Some risks are accepted, not resolved

Auditors will ask “why was this left unfixed?”

Therefore:

Context is mandatory

Risk scoring must be explainable

Acceptance must be explicit and time-bound

Historical state must be preserved

2. HIGH-LEVEL SYSTEM RESPONSIBILITIES
What Vulnerability Management owns

Asset vulnerability discovery

Configuration and exposure assessment

Vulnerability normalisation (CVE, CPE, vendor IDs)

Contextual risk scoring

Remediation recommendation generation

Risk acceptance and exception tracking

Evidence generation for compliance

What it does not own

Patch execution (RMM does)

Exploit detection (EDR does)

Incident response (PSA does)

Behaviour correlation (SIEM does)

Vulnerability Management informs decisions, it does not enforce them.

3. DATA ARCHITECTURE OVERVIEW

This module is relational and historical by nature.

You need to model:

Assets (referenced, not duplicated)

Vulnerabilities (canonical)

Observations (this vuln on this asset at this time)

Risk decisions (fix, defer, accept)

Evidence and justification

PostgreSQL is ideal here, and unlike SIEM or EDR, this module benefits heavily from slowly changing dimensions and temporal integrity.

4. DATABASE SCHEMA (DETAILED)
A. CANONICAL VULNERABILITY INTELLIGENCE
vulnerabilities

Authoritative vulnerability definitions.

Field	Type	Purpose
id	UUID (PK)	Internal ID
cve_id	TEXT	CVE identifier
title	TEXT	Short description
description	TEXT	Full description
cvss_score	NUMERIC	Base score
cvss_vector	TEXT	Vector string
severity	INTEGER	Normalised
published_at	TIMESTAMP	Disclosure date

This table is global and reusable.

vulnerability_references
Field	Type
vulnerability_id	UUID
reference_type	TEXT
reference_url	TEXT

Used for advisories, vendor bulletins, exploits.

B. ASSET EXPOSURE AND OBSERVATIONS
asset_vulnerabilities

This is the core observation table.

Field	Type	Purpose
id	UUID (PK)	Observation ID
asset_id	UUID (FK assets)	Affected asset
vulnerability_id	UUID	CVE
detection_source	TEXT	scanner, audit
first_seen	TIMESTAMP	Initial detection
last_seen	TIMESTAMP	Most recent
status	TEXT	open, remediated
proof	JSONB	Detection evidence

This table is append-updated, never overwritten blindly.

vulnerability_scans
Field	Type
id	UUID
scan_type	TEXT
tool	TEXT
started_at	TIMESTAMP
completed_at	TIMESTAMP
status	TEXT

Allows traceability of discovery.

C. CONTEXTUAL RISK SCORING
risk_assessments
Field	Type	Purpose
id	UUID	Assessment ID
asset_vulnerability_id	UUID	Target
exploitability	INTEGER	Likelihood
impact	INTEGER	Business impact
exposure	INTEGER	Network exposure
adjusted_risk	INTEGER	Final score
assessed_at	TIMESTAMP	Time

This is where CVSS is adjusted, not replaced.

risk_factors
Field	Type
risk_assessment_id	UUID
factor_type	TEXT
factor_value	TEXT

This makes your scoring explainable later.

D. REMEDIATION AND DECISION TRACKING
remediation_recommendations
Field	Type
id	UUID
vulnerability_id	UUID
recommended_action	TEXT
automation_possible	BOOLEAN
notes	TEXT

Reusable across assets.

risk_decisions

This is critical for audits.

Field	Type	Purpose
id	UUID	Decision ID
asset_vulnerability_id	UUID	Target
decision	TEXT	remediate, accept
justification	TEXT	Reason
decided_by	UUID (FK users)	Owner
valid_until	TIMESTAMP	Expiry
created_at	TIMESTAMP	Decision time

No vulnerability should exist without a decision.

E. PSA INTEGRATION (WORK CREATION)
vulnerability_cases
Field	Type
asset_vulnerability_id	UUID
psa_case_id	UUID
created_at	TIMESTAMP

This ensures remediation becomes work, not suggestion.

F. EVIDENCE AND COMPLIANCE SUPPORT
vulnerability_evidence
Field	Type
id	UUID
asset_vulnerability_id	UUID
evidence_type	TEXT
storage_uri	TEXT
hash	TEXT
captured_at	TIMESTAMP

Used heavily by Compliance Auditing later.

5. CORE WORKFLOWS
Discovery → observation

Scanner runs

Vulnerabilities identified

Canonical CVE resolved or created

Asset exposure recorded

First seen timestamp preserved

Observation → risk assessment

Context applied (asset criticality, exposure)

Risk scored transparently

Factors recorded

Assessment versioned over time

Risk → decision

Remediate, accept, defer or mitigate

Justification recorded

Expiry enforced

PSA case created if remediation required

Remediation → closure

RMM executes patch or config change

Scanner verifies fix

Observation marked remediated

Evidence attached

Case closed in PSA

6. SECURITY AND AUDITABILITY

This module must provide:

Full historical vulnerability timelines

Evidence-backed acceptance decisions

Time-limited exceptions

Separation between detection and approval

Immutable audit trail

Auditors care less about perfection and more about governance.

7. DESIGN TRAPS TO AVOID

These are industry-standard failures:

Treating CVSS as gospel

Deleting vulnerabilities when “fixed”

Allowing permanent risk acceptance

Losing linkage between scan and decision

Generating tickets without context

Avoid these and your platform will feel mature.

8. HOW THIS FITS YOUR PLATFORM

Feeds PSA

Remediation work

Risk acceptance records

Evidence for audits

Feeds SIEM

Context for alerts (known vulnerable asset)

Risk amplification

Feeds EDR

Priority tuning

Compensating control awareness

This is where “security posture” becomes real.

9. WHY THIS DESIGN HOLDS UP

With this approach:

You can defend every unfixed vulnerability

You can explain prioritisation decisions

You can prove continuous risk management

You can survive external audits calmly

This is vulnerability management done as governance, not whack-a-mole.