"""Lifecycle transition rules for vulnerability records."""
from __future__ import annotations

from .models import LifecycleState


ALLOWED_TRANSITIONS: dict[LifecycleState, set[LifecycleState]] = {
    "detected": {"assessed", "mitigated", "remediated", "accepted", "superseded"},
    "assessed": {"mitigated", "remediated", "accepted", "superseded"},
    "mitigated": {"remediated", "accepted", "superseded"},
    "remediated": {"superseded"},
    "accepted": {"superseded"},
    "superseded": set(),
}


def can_transition(current: LifecycleState, target: LifecycleState) -> bool:
    """Return True when a transition is permitted."""
    return target in ALLOWED_TRANSITIONS.get(current, set())
